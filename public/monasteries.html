<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>MÄƒnÄƒstiri Ortodoxe - DOXA</title>
  <link rel="stylesheet" href="/src/index.css">
  <style>
    .map-section {
      height: 400px;
      background-color: #e9ecef;
      border-radius: 8px;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      text-align: center;
    }
    
    .filters-container {
      background-color: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 2rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .filter-group {
      margin-bottom: 1rem;
    }
    
    .filter-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .filter-group select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .regions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }
    
    .region-card {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
    }
    
    .region-card:hover {
      transform: translateY(-5px);
    }
    
    .region-image {
      height: 150px;
      overflow: hidden;
    }
    
    .region-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .region-content {
      padding: 1.5rem;
    }
    
    .region-title {
      font-size: 1.25rem;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .region-count {
      color: var(--light-text);
      margin-bottom: 1rem;
    }
    
    .empty-state {
      text-align: center;
      padding: 3rem;
      background-color: #f8f9fa;
      border-radius: 8px;
      margin: 2rem 0;
    }
    
    @media (max-width: 768px) {
      .filters-grid {
        grid-template-columns: 1fr;
      }
      
      .regions-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div id="root">
    <div class="loading-container">
      <div class="loading-box">
        <h1>DOXA</h1>
        <p>PlatformÄƒ de Pelerinaje Ortodoxe</p>
        <div class="spinner"></div>
        <p>Se Ã®ncarcÄƒ mÄƒnÄƒstirile...</p>
      </div>
    </div>
  </div>

  <script>
    // Stare pentru pagina de mÄƒnÄƒstiri
    const pageState = {
      loading: true,
      monasteries: [],
      filteredMonasteries: [],
      regions: [],
      error: null, // AdÄƒugÄƒm un cÃ¢mp pentru mesajele de eroare
      filters: {
        region: '',
        type: '',
        hasRelics: false
      }
    };
    
    // FuncÈ›ie helper pentru crearea elementelor DOM
    function createElement(tag, props, ...children) {
      const element = document.createElement(tag);
      
      if (props) {
        Object.entries(props).forEach(([key, value]) => {
          if (key === 'className') {
            element.className = value;
          } else if (key === 'style' && typeof value === 'object') {
            Object.assign(element.style, value);
          } else if (key.startsWith('on') && typeof value === 'function') {
            const eventName = key.substring(2).toLowerCase();
            element.addEventListener(eventName, value);
          } else {
            element.setAttribute(key, value);
          }
        });
      }
      
      children.flat().forEach(child => {
        if (child === null || child === undefined) return;
        
        const node = 
          typeof child === 'string' || typeof child === 'number'
            ? document.createTextNode(child.toString())
            : child;
            
        element.appendChild(node);
      });
      
      return element;
    }
    
    // Componente pentru pagina de mÄƒnÄƒstiri
    function createNavbar() {
      return createElement('nav', { className: 'navbar' },
        createElement('div', { className: 'container navbar-content' },
          createElement('a', { href: '/', className: 'navbar-brand' },
            'DOXA'
          ),
          createElement('div', { className: 'navbar-links' },
            createElement('a', { href: '/pilgrimages' }, 'Pelerinaje'),
            createElement('a', { href: '/monasteries', className: 'active' }, 'MÄƒnÄƒstiri'),
            createElement('a', { href: '/calendar' }, 'Calendar Ortodox'),
            createElement('a', { href: '/fasting-recipes' }, 'ReÈ›ete de Post'),
            createElement('a', { href: '/doxa-ai' }, 'DOXA AI')
          ),
          createElement('div', { className: 'navbar-auth' },
            createElement('a', { href: '/auth', className: 'btn btn-outline' }, 'Autentificare'),
            createElement('a', { href: '/auth?mode=register', className: 'btn btn-primary' }, 'ÃŽnregistrare')
          )
        )
      );
    }
    
    function createPageHeader() {
      return createElement('section', { className: 'container', style: { padding: '2rem 0' } },
        createElement('h1', { style: { marginBottom: '1rem', color: 'var(--primary-color)' } }, 'MÄƒnÄƒstiri Ortodoxe'),
        createElement('p', null, 'DescoperÄƒ mÄƒnÄƒstirile ortodoxe din RomÃ¢nia È™i Ã®ntreaga lume. ExploreazÄƒ istoria, arhitectura È™i spiritualitatea acestor locuri sfinte.')
      );
    }
    
    function createMap() {
      // Placerholder pentru o viitoare hartÄƒ interactivÄƒ
      return createElement('div', { className: 'container' },
        createElement('div', { className: 'map-section' },
          createElement('div', null,
            createElement('h3', null, 'HartÄƒ interactivÄƒ'),
            createElement('p', null, 'Harta mÄƒnÄƒstirilor ortodoxe va fi disponibilÄƒ Ã®n curÃ¢nd!')
          )
        )
      );
    }
    
    function createFilters() {
      const regions = ['Toate regiunile', 'Moldova', 'Bucovina', 'Muntenia', 'Oltenia', 'Transilvania', 'MaramureÈ™', 'Banat', 'Dobrogea'];
      const types = ['Toate tipurile', 'MÄƒnÄƒstire', 'Schit', 'BisericÄƒ'];

      return createElement('div', { className: 'container' },
        createElement('div', { className: 'filters-container' },
          createElement('h2', { style: { marginBottom: '1rem' } }, 'FiltreazÄƒ mÄƒnÄƒstirile'),
          createElement('div', { className: 'filters-grid' },
            // Filtru regiune
            createElement('div', { className: 'filter-group' },
              createElement('label', { htmlFor: 'region-filter' }, 'Regiune'),
              createElement('select', { 
                id: 'region-filter',
                onChange: (e) => {
                  pageState.filters.region = e.target.value.toLowerCase();
                  applyFilters();
                }
              }, ...regions.map((region) => 
                createElement('option', { value: region === 'Toate regiunile' ? '' : region.toLowerCase() }, region)
              ))
            ),
            
            // Filtru tip
            createElement('div', { className: 'filter-group' },
              createElement('label', { htmlFor: 'type-filter' }, 'Tip lÄƒcaÈ™'),
              createElement('select', { 
                id: 'type-filter',
                onChange: (e) => {
                  pageState.filters.type = e.target.value.toLowerCase();
                  applyFilters();
                }
              }, ...types.map((type) => 
                createElement('option', { value: type === 'Toate tipurile' ? '' : type.toLowerCase() }, type)
              ))
            ),
            
            // Filtru relicve (moaÈ™te)
            createElement('div', { className: 'filter-group' },
              createElement('label', { htmlFor: 'relics-filter' }, 'Relicve'),
              createElement('div', { style: { display: 'flex', alignItems: 'center', marginTop: '0.5rem' } },
                createElement('input', { 
                  type: 'checkbox', 
                  id: 'relics-filter',
                  style: { marginRight: '0.5rem' },
                  onChange: (e) => {
                    pageState.filters.hasRelics = e.target.checked;
                    applyFilters();
                  }
                }),
                createElement('span', null, 'Doar mÄƒnÄƒstiri cu moaÈ™te sfinte')
              )
            )
          )
        )
      );
    }
    
    function createRegionsSection() {
      if (pageState.loading) {
        return createElement('div', { className: 'container', style: { textAlign: 'center', padding: '3rem 0' } },
          createElement('div', { className: 'spinner', style: { margin: '0 auto' } }),
          createElement('p', null, 'Se Ã®ncarcÄƒ regiunile...')
        );
      }
      
      // AfiÈ™Äƒm notificarea de eroare dacÄƒ existÄƒ
      if (pageState.error) {
        return createElement('div', { className: 'container', style: { padding: '2rem 0' } },
          createElement('div', { 
            style: { 
              padding: '1rem', 
              backgroundColor: '#fff3cd', 
              color: '#856404', 
              borderRadius: '8px',
              marginBottom: '2rem',
              border: '1px solid #ffeeba'
            } 
          }, 
            createElement('p', { style: { fontWeight: 'bold' } }, 'âš ï¸ Notificare'),
            createElement('p', null, pageState.error),
            createElement('p', null, 'Datele afiÈ™ate sunt demonstrative È™i nu reflectÄƒ informaÈ›iile reale din baza de date.')
          )
        );
      }
      
      // GrupÄƒm mÄƒnÄƒstirile pe regiuni È™i numÄƒrÄƒm cÃ¢te sunt Ã®n fiecare regiune
      const regionMap = new Map();
      
      pageState.monasteries.forEach(monastery => {
        const region = monastery.region.charAt(0).toUpperCase() + monastery.region.slice(1);
        if (!regionMap.has(region)) {
          regionMap.set(region, {
            name: region,
            count: 0,
            image: `/images/regions/${monastery.region}.jpg`
          });
        }
        
        const regionData = regionMap.get(region);
        regionData.count++;
      });
      
      const regions = Array.from(regionMap.values());
      
      if (regions.length === 0) {
        return createElement('div', { className: 'container empty-state' },
          createElement('h3', null, 'Nu am gÄƒsit regiuni'),
          createElement('p', null, 'Nu existÄƒ regiuni Ã®nregistrate Ã®n baza de date. ÃŽncercaÈ›i sÄƒ reveniÈ›i mai tÃ¢rziu.')
        );
      }
      
      const regionCards = regions.map(region => {
        return createElement('div', { className: 'region-card' },
          createElement('div', { className: 'region-image' },
            createElement('img', { src: region.image || '/images/default-region.jpg', alt: region.name })
          ),
          createElement('div', { className: 'region-content' },
            createElement('h3', { className: 'region-title' }, region.name),
            createElement('p', { className: 'region-count' }, `${region.count} mÄƒnÄƒstiri`),
            createElement('a', { 
              href: `/monasteries?region=${region.name.toLowerCase()}`, 
              className: 'btn btn-primary'
            }, 'ExploreazÄƒ')
          )
        );
      });
      
      return createElement('div', { className: 'container', style: { padding: '2rem 0' } },
        createElement('div', { className: 'section-title' },
          createElement('h2', null, 'Regiuni de pelerinaj'),
          createElement('p', null, 'ExploreazÄƒ mÄƒnÄƒstirile È™i schiturile din diferite regiuni istorice')
        ),
        createElement('div', { className: 'regions-grid' }, ...regionCards)
      );
    }
    
    function createMonasteriesList() {
      if (pageState.loading) {
        return createElement('div', { className: 'container', style: { textAlign: 'center', padding: '3rem 0' } },
          createElement('div', { className: 'spinner', style: { margin: '0 auto' } }),
          createElement('p', null, 'Se Ã®ncarcÄƒ mÄƒnÄƒstirile...')
        );
      }
      
      const monasteries = pageState.filteredMonasteries.length > 0 ? pageState.filteredMonasteries : pageState.monasteries;
      
      if (monasteries.length === 0) {
        return createElement('div', { className: 'container empty-state' },
          createElement('h3', null, 'Nu am gÄƒsit mÄƒnÄƒstiri'),
          createElement('p', null, 'Nu existÄƒ mÄƒnÄƒstiri care sÄƒ corespundÄƒ criteriilor selectate. ÃŽncercaÈ›i sÄƒ modificaÈ›i filtrele sau sÄƒ reveniÈ›i mai tÃ¢rziu.')
        );
      }
      
      const monasteryCards = monasteries.map(monastery => {
        return createElement('div', { className: 'monastery-card' },
          createElement('div', { className: 'monastery-image' },
            createElement('img', { src: monastery.coverImage || '/images/default-monastery.jpg', alt: monastery.name })
          ),
          createElement('div', { className: 'monastery-content' },
            createElement('h3', { className: 'monastery-title' }, monastery.name),
            createElement('div', { className: 'monastery-location' },
              createElement('span', null, `${monastery.city}, ${monastery.county}`)
            ),
            createElement('p', { className: 'monastery-description' }, monastery.shortDescription || monastery.description.substring(0, 100) + '...'),
            createElement('a', { href: `/monasteries/${monastery.slug || monastery.id}`, className: 'btn btn-outline' }, 'ViziteazÄƒ')
          )
        );
      });
      
      return createElement('div', { className: 'container', style: { padding: '2rem 0' } },
        createElement('div', { className: 'section-title' },
          createElement('h2', null, 'MÄƒnÄƒstiri populare'),
          createElement('p', null, 'DescoperÄƒ cele mai frumoase È™i vizitate mÄƒnÄƒstiri ortodoxe')
        ),
        createElement('div', { className: 'monasteries-grid' }, ...monasteryCards)
      );
    }
    
    function createFooter() {
      return createElement('footer', { className: 'footer' },
        createElement('div', { className: 'container' },
          createElement('div', { className: 'footer-grid' },
            // Coloana brand
            createElement('div', { className: 'footer-brand' },
              createElement('a', { href: '/' }, 'DOXA'),
              createElement('p', null, 'PlatformÄƒ dedicatÄƒ cÄƒlÄƒtoriilor spirituale È™i tradiÈ›iilor ortodoxe, oferind acces la pelerinaje, mÄƒnÄƒstiri È™i resurse spirituale.'),
              createElement('div', { className: 'footer-social' },
                createElement('a', { href: '#', 'aria-label': 'Facebook' }, 'ðŸ“±'),
                createElement('a', { href: '#', 'aria-label': 'Instagram' }, 'ðŸ“·'),
                createElement('a', { href: '#', 'aria-label': 'YouTube' }, 'ðŸ“º')
              )
            ),
            
            // Coloana pelerinaje
            createElement('div', { className: 'footer-links' },
              createElement('h3', null, 'Pelerinaje'),
              createElement('ul', null,
                createElement('li', null, createElement('a', { href: '/pilgrimages' }, 'Toate pelerinajele')),
                createElement('li', null, createElement('a', { href: '/pilgrimages?featured=true' }, 'Pelerinaje promovate')),
                createElement('li', null, createElement('a', { href: '/pilgrimages?upcoming=true' }, 'Pelerinaje viitoare')),
                createElement('li', null, createElement('a', { href: '/organizer/register' }, 'Devino organizator'))
              )
            ),
            
            // Coloana mÄƒnÄƒstiri
            createElement('div', { className: 'footer-links' },
              createElement('h3', null, 'MÄƒnÄƒstiri'),
              createElement('ul', null,
                createElement('li', null, createElement('a', { href: '/monasteries' }, 'Toate mÄƒnÄƒstirile')),
                createElement('li', null, createElement('a', { href: '/monasteries?region=moldova' }, 'MÄƒnÄƒstiri din Moldova')),
                createElement('li', null, createElement('a', { href: '/monasteries?region=muntenia' }, 'MÄƒnÄƒstiri din Muntenia')),
                createElement('li', null, createElement('a', { href: '/monasteries?region=transilvania' }, 'MÄƒnÄƒstiri din Transilvania'))
              )
            ),
            
            // Coloana resurse
            createElement('div', { className: 'footer-links' },
              createElement('h3', null, 'Resurse'),
              createElement('ul', null,
                createElement('li', null, createElement('a', { href: '/calendar' }, 'Calendar ortodox')),
                createElement('li', null, createElement('a', { href: '/fasting-recipes' }, 'ReÈ›ete de post')),
                createElement('li', null, createElement('a', { href: '/doxa-ai' }, 'Asistent DOXA AI')),
                createElement('li', null, createElement('a', { href: '/about' }, 'Despre noi'))
              )
            )
          ),
          
          createElement('div', { className: 'footer-bottom' },
            createElement('p', null, 'Â© 2025 DOXA. Toate drepturile rezervate.'),
            createElement('p', null,
              createElement('a', { href: '/terms' }, 'Termeni È™i condiÈ›ii'),
              ' | ',
              createElement('a', { href: '/privacy' }, 'Politica de confidenÈ›ialitate'),
              ' | ',
              createElement('a', { href: '/cookies' }, 'Politica de cookies')
            )
          )
        )
      );
    }
    
    // FuncÈ›ie pentru a construi pagina de mÄƒnÄƒstiri
    function createMonasteriesPage() {
      return createElement('div', { className: 'app-container' },
        createNavbar(),
        createPageHeader(),
        createMap(),
        createFilters(),
        createRegionsSection(),
        createMonasteriesList(),
        createFooter()
      );
    }
    
    // FuncÈ›ie pentru aplicarea filtrelor
    function applyFilters() {
      const { region, type, hasRelics } = pageState.filters;
      
      pageState.filteredMonasteries = pageState.monasteries.filter(monastery => {
        // Filtrare dupÄƒ regiune
        if (region && monastery.region !== region) {
          return false;
        }
        
        // Filtrare dupÄƒ tip
        if (type && monastery.type !== type) {
          return false;
        }
        
        // Filtrare dupÄƒ relicve (moaÈ™te)
        if (hasRelics && (!monastery.relics || monastery.relics.length === 0)) {
          return false;
        }
        
        return true;
      });
      
      renderPage();
    }
    
    // FuncÈ›ie pentru Ã®ncÄƒrcarea mÄƒnÄƒstirilor
    function loadMonasteries() {
      pageState.loading = true;
      renderPage();
      
      // Date de test pentru cazul cÃ¢nd API-ul nu rÄƒspunde
      const testMonasteries = [
        {
          id: 1,
          name: "MÄƒnÄƒstirea Putna",
          description: "MÄƒnÄƒstirea Putna este o mÄƒnÄƒstire ortodoxÄƒ de cÄƒlugÄƒri din RomÃ¢nia, construitÄƒ Ã®ntre anii 1466â€“1469 È™i ctitoritÄƒ de domnitorul È˜tefan cel Mare.",
          shortDescription: "Ctitorie a lui È˜tefan cel Mare, un important centru religios È™i cultural.",
          city: "Putna",
          county: "Suceava",
          region: "moldova",
          type: "monastery",
          coverImage: "/static/images/monasteries/putna.jpg",
          relics: ["MoaÈ™tele SfÃ¢ntului Ghenadie"]
        },
        {
          id: 2,
          name: "MÄƒnÄƒstirea VoroneÈ›",
          description: "MÄƒnÄƒstirea VoroneÈ›, cunoscutÄƒ pentru albastrul sÄƒu unic, a fost construitÄƒ Ã®n 1488 de È˜tefan cel Mare È™i este parte din patrimoniul UNESCO.",
          shortDescription: "CunoscutÄƒ pentru 'Albastrul de VoroneÈ›', una dintre cele mai valoroase ctitorii ale lui È˜tefan cel Mare.",
          city: "Gura Humorului",
          county: "Suceava",
          region: "bucovina",
          type: "monastery",
          coverImage: "/static/images/monasteries/voronet.jpg"
        },
        {
          id: 3,
          name: "MÄƒnÄƒstirea SÃ¢mbÄƒta de Sus",
          description: "MÄƒnÄƒstirea SÃ¢mbÄƒta de Sus, cunoscutÄƒ È™i ca 'Catedrala din MunÈ›i', a fost construitÄƒ de Constantin BrÃ¢ncoveanu Ã®n 1696.",
          shortDescription: "CunoscutÄƒ È™i ca 'Catedrala din MunÈ›i', un important centru spiritual din Transilvania.",
          city: "SÃ¢mbÄƒta de Sus",
          county: "BraÈ™ov",
          region: "transilvania",
          type: "monastery",
          coverImage: "/static/images/monasteries/sambata.jpg"
        }
      ];
      
      fetch('/api/monasteries')
        .then(response => {
          if (!response.ok) {
            throw new Error(`RÄƒspuns invalid de la server: ${response.status} ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => {
          console.log("MÄƒnÄƒstiri primite de la server:", data.length);
          pageState.monasteries = Array.isArray(data) ? data : [];
          pageState.loading = false;
          renderPage();
        })
        .catch(error => {
          console.error('Eroare la comunicarea cu serverul:', error);
          
          // Folosim date de test Ã®n caz de eroare
          console.log('Folosim date de rezervÄƒ pentru mÄƒnÄƒstiri');
          pageState.monasteries = testMonasteries;
          pageState.loading = false;
          
          // AdÄƒugÄƒm o notificare pentru utilizator despre utilizarea datelor locale
          pageState.error = "Nu s-a putut conecta la serverul de date. Se afiÈ™eazÄƒ informaÈ›ii demonstrative.";
          
          renderPage();
        });
    }
    
    // FuncÈ›ie pentru randarea paginii
    function renderPage() {
      const container = document.getElementById('root');
      if (container) {
        container.innerHTML = '';
        container.appendChild(createMonasteriesPage());
      }
    }
    
    // IniÈ›ializare paginÄƒ
    document.addEventListener('DOMContentLoaded', () => {
      try {
        // ÃŽncÄƒrcÄƒm mÄƒnÄƒstirile
        loadMonasteries();
      } catch (error) {
        console.error('Eroare la iniÈ›ializarea paginii de mÄƒnÄƒstiri:', error);
        
        const rootElement = document.getElementById("root");
        if (rootElement) {
          rootElement.innerHTML = `
            <div class="card" style="max-width: 800px; margin: 50px auto;">
              <h2 style="color: #e74c3c;">Eroare la iniÈ›ializarea paginii</h2>
              <p>A apÄƒrut o eroare la Ã®ncÄƒrcarea paginii de mÄƒnÄƒstiri. Detalii Ã®n consola browser-ului.</p>
              <p>Eroare: ${error.message}</p>
              <div style="margin-top: 20px;">
                <button onclick="location.reload()" class="btn">ReÃ®ncarcÄƒ pagina</button>
              </div>
            </div>
          `;
        }
      }
    });
  </script>
</body>
</html>