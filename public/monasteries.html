<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>Mănăstiri Ortodoxe - DOXA</title>
  <link rel="stylesheet" href="/src/index.css">
  <style>
    .map-section {
      height: 400px;
      background-color: #e9ecef;
      border-radius: 8px;
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      text-align: center;
    }
    
    .filters-container {
      background-color: #f8f9fa;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 2rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
    }
    
    .filter-group {
      margin-bottom: 1rem;
    }
    
    .filter-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .filter-group select {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    
    .regions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }
    
    .region-card {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: var(--transition);
    }
    
    .region-card:hover {
      transform: translateY(-5px);
    }
    
    .region-image {
      height: 150px;
      overflow: hidden;
    }
    
    .region-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .region-content {
      padding: 1.5rem;
    }
    
    .region-title {
      font-size: 1.25rem;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }
    
    .region-count {
      color: var(--light-text);
      margin-bottom: 1rem;
    }
    
    .empty-state {
      text-align: center;
      padding: 3rem;
      background-color: #f8f9fa;
      border-radius: 8px;
      margin: 2rem 0;
    }
    
    @media (max-width: 768px) {
      .filters-grid {
        grid-template-columns: 1fr;
      }
      
      .regions-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div id="root">
    <div class="loading-container">
      <div class="loading-box">
        <h1>DOXA</h1>
        <p>Platformă de Pelerinaje Ortodoxe</p>
        <div class="spinner"></div>
        <p>Se încarcă mănăstirile...</p>
      </div>
    </div>
  </div>

  <script>
  // Funcție pentru a afișa notificarea de eroare
  function showConnectionError() {
    const errorDiv = document.createElement('div');
    errorDiv.className = 'connection-error';
    errorDiv.innerHTML = `
      <div class="alert alert-warning" role="alert">
        <h4><i class="fas fa-exclamation-triangle"></i> ⚠️ Notificare</h4>
        <p>Nu s-a putut conecta la serverul de date. Se afișează informații demonstrative.</p>
        <p>Datele afișate sunt demonstrative și nu reflectă informațiile reale din baza de date.</p>
      </div>
    `;
    
    // Verificăm dacă există elementul main, iar dacă nu, adăugăm la root
    const targetElement = document.querySelector('main') || document.getElementById('root');
    if (targetElement) {
      targetElement.prepend(errorDiv);
    } else {
      // Dacă nici root nu există, adăugăm la body
      document.body.prepend(errorDiv);
    }
  }

  // Funcție pentru a încărca mănăstirile
  async function loadMonasteries() {
    try {
      // Încercăm să obținem datele de la API
      const response = await fetch('/api/monasteries');
      
      // Verificăm dacă API-ul a răspuns cu succes
      if (response.ok) {
        const monasteries = await response.json();
        displayMonasteries(monasteries);
      } else {
        throw new Error('Eroare la comunicarea cu serverul');
      }
    } catch (error) {
      console.error("Eroare la încărcarea mănăstirilor:", error);
      
      // Dacă API-ul eșuează, încărcăm datele de rezervă
      console.log("Folosim date de rezervă pentru mănăstiri");
      showConnectionError();
      
      try {
        const fallbackResponse = await fetch('/fallback-data/monasteries.json');
        const fallbackData = await fallbackResponse.json();
        displayMonasteries(fallbackData);
      } catch (fallbackError) {
        console.error("Eroare la încărcarea datelor de rezervă:", fallbackError);
        
        // Folosim date hardcoded ca ultimă soluție
        const backupData = [
          {
            id: 1,
            name: "Mănăstirea Putna",
            description: "Mănăstirea Putna, ctitorie a lui Ștefan cel Mare (1466-1469), este unul dintre cele mai importante centre spirituale și culturale ale Ortodoxiei românești.",
            location: "Putna, Suceava",
            yearFounded: 1466,
            image: "/images/monastery-placeholder.jpg",
            region: "moldova"
          },
          {
            id: 2,
            name: "Mănăstirea Voroneț",
            description: "Mănăstirea Voroneț, cunoscută pentru „albastrul de Voroneț" - culoarea unică a frescelor exterioare, este una dintre cele mai valoroase ctitorii ale lui Ștefan cel Mare.",
            location: "Gura Humorului, Suceava",
            yearFounded: 1488,
            image: "/images/monastery-placeholder.jpg",
            region: "bucovina"
          },
          {
            id: 3,
            name: "Mănăstirea Neamț",
            description: "Mănăstirea Neamț, cunoscută și ca „Lavra Neamțului", este una dintre cele mai vechi și mai importante mănăstiri din Moldova.",
            location: "Târgu Neamț, Neamț",
            yearFounded: 1407,
            image: "/images/monastery-placeholder.jpg",
            region: "moldova"
          }
        ];
        displayMonasteries(backupData);
      }
    }
  }

  // Funcție pentru a afișa mănăstirile
  function displayMonasteries(monasteries) {
    let container = document.getElementById('monasteries-container');
    
    // Dacă containerul nu există, îl creăm
    if (!container) {
      container = document.createElement('div');
      container.id = 'monasteries-container';
      container.className = 'row mt-4';
      
      // Adăugăm structura de bază dacă nu există
      const mainContent = document.createElement('main');
      mainContent.className = 'container py-4';
      mainContent.innerHTML = `
        <h1 class="mb-4">Mănăstiri Ortodoxe</h1>
        <div class="row">
          <div class="col-12 mb-4">
            <div class="filters-container">
              <h2 class="h5 mb-3">Filtrează mănăstirile</h2>
              <div class="filters-grid">
                <!-- Filtrele vor fi adăugate ulterior -->
              </div>
            </div>
          </div>
        </div>
      `;
      
      mainContent.appendChild(container);
      document.getElementById('root').appendChild(mainContent);
    }
    
    container.innerHTML = '';
    
    monasteries.forEach(monastery => {
      const card = document.createElement('div');
      card.className = 'col-md-4 mb-4';
      card.innerHTML = `
        <div class="card h-100 monastery-card">
          <img src="${monastery.image || '/public/images/monastery-placeholder.jpg'}" 
               class="card-img-top" alt="${monastery.name}"
               onerror="this.src='/public/images/monastery-placeholder.jpg'">
          <div class="card-body">
            <h5 class="card-title">${monastery.name}</h5>
            <p class="card-text">
              <small class="text-muted"><i class="fas fa-map-marker-alt"></i> ${monastery.location || 'Locație necunoscută'}</small>
            </p>
            <p class="card-text"><i class="fas fa-calendar-alt"></i> An fondare: ${monastery.yearFounded || 'Necunoscut'}</p>
            <p class="card-text">${monastery.description || 'Fără descriere'}</p>
          </div>
          <div class="card-footer">
            <a href="#" class="btn btn-primary view-details" data-id="${monastery.id}">
              Vezi detalii <i class="fas fa-arrow-right"></i>
            </a>
          </div>
        </div>
      `;
      container.appendChild(card);
    });
  }

  // Încărcăm mănăstirile când pagina se încarcă
  document.addEventListener('DOMContentLoaded', loadMonasteries);
</script>
</body>
</html>